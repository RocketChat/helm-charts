# Rocket.Chat Values Template for Tainted Nodes
# =============================================
# Copy this file and modify the scheduling section to match your node taints/labels.
# YAML anchors ensure scheduling config is defined once and applied everywhere.
#
# Usage:
#   cp values-taint-template.yaml my-values.yaml
#   # Edit scheduling.tolerations and scheduling.nodeSelector in my-values.yaml
#   helm install rocketchat ./rocketchat -f my-values.yaml
#

# Define scheduling config once - all other sections reference this via YAML anchors
scheduling:
  tolerations: &tolerations
    - key: "dedicated"
      operator: "Equal"
      value: "rocketchat"
      effect: "NoSchedule"
  # Uncomment and modify to target specific nodes by label
  # nodeSelector: &nodeSelector
  #   dedicated: rocketchat
  nodeSelector: &nodeSelector {}
  affinity: &affinity {}

# Global settings apply to all Rocket.Chat pods (main and microservices)
global:
  tolerations: *tolerations
  nodeSelector: *nodeSelector
  affinity: *affinity

# NATS subchart - requires explicit config (doesn't inherit from global)
nats:
  tolerations: *tolerations
  nodeSelector: *nodeSelector
  natsbox:
    tolerations: *tolerations
    nodeSelector: *nodeSelector

# Microservices tolerations (optional - uses global.tolerations by default)
# Uncomment only if you need different tolerations per microservice
# microservices:
#   presence:
#     tolerations: *tolerations
#   ddpStreamer:
#     tolerations: *tolerations
#   account:
#     tolerations: *tolerations
#   authorization:
#     tolerations: *tolerations
#   streamHub:
#     tolerations: *tolerations
